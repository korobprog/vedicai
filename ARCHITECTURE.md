# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Rag Agent

## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

Rag Agent - —ç—Ç–æ –º–æ–±–∏–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (React Native) —Å –±–µ–∫–µ–Ω–¥–æ–º –Ω–∞ Go, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —á–∞—Ç-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å AI –º–æ–¥–µ–ª—è–º–∏ —á–µ—Ä–µ–∑ –≤–Ω–µ—à–Ω–∏–π API, –∞ —Ç–∞–∫–∂–µ —Å–∏—Å—Ç–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π RAG (Retrieval-Augmented Generation) –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤.

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  React Native   ‚îÇ  Frontend (Android/iOS)
‚îÇ     App         ‚îÇ  –ü–æ—Ä—Ç: 8082 (Metro)
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ HTTP
         ‚îÇ http://10.0.2.2:8081/api/v1/chat/completions
         ‚îÇ (Android Emulator ‚Üí localhost:8081)
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Go Backend    ‚îÇ  Fiber Framework
‚îÇ   Port: 8081    ‚îÇ  /api/v1/chat/completions
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ HTTP Proxy
         ‚îÇ https://rvlautoai.ru/webhook/v1/chat/completions
         ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  External API   ‚îÇ  RVFreeLLM API
‚îÇ  rvlautoai.ru   ‚îÇ  –ú–Ω–æ–∂–µ—Å—Ç–≤–æ AI –º–æ–¥–µ–ª–µ–π
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  PostgreSQL     ‚îÇ  –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   Port: 5435    ‚îÇ  –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –ø—Ä–æ—Ñ–∏–ª–∏
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Google Gemini  ‚îÇ  RAG —Å–∏—Å—Ç–µ–º–∞
‚îÇ   RAG Store     ‚îÇ  –•—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## Frontend (React Native)

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **Framework**: React Native 0.76.5
- **Language**: TypeScript
- **Metro Port**: 8082
- **Package Manager**: pnpm

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞
```
frontend/
‚îú‚îÄ‚îÄ App.tsx                    # –ì–ª–∞–≤–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å —á–∞—Ç–æ–º
‚îú‚îÄ‚îÄ RegistrationScreen.tsx     # –≠–∫—Ä–∞–Ω —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îú‚îÄ‚îÄ SettingsDrawer.tsx         # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ (–º–æ–¥–µ–ª–∏, –ø—Ä–æ–≤–∞–π–¥–µ—Ä—ã)
‚îú‚îÄ‚îÄ ChatImage.tsx              # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ —á–∞—Ç–µ
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ openaiService.ts      # –°–µ—Ä–≤–∏—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å AI API
‚îú‚îÄ‚îÄ config/
‚îÇ   ‚îî‚îÄ‚îÄ models.config.ts      # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
‚îî‚îÄ‚îÄ context/
    ‚îî‚îÄ‚îÄ SettingsContext.tsx    # –ö–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
```

### API Endpoints (Frontend ‚Üí Backend)
- **Base URL**: `http://10.0.2.2:8081/api` (Android Emulator)
- **Chat**: `POST /v1/chat/completions`
- **Models**: `GET /v1/models`

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –º–æ–¥–µ–ª–µ–π
–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:
- **Text**: `meta-llama/Llama-3.3-70B-Instruct-Turbo` (DeepInfra)
- **Audio**: `alloy` (OpenAIFM)
- **Image**: `flux` (PollinationsAI)

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `API_OPEN_AI` - API –∫–ª—é—á –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ API (—á–µ—Ä–µ–∑ react-native-config)

## Backend (Go)

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
- **Framework**: Fiber v2
- **Language**: Go
- **Port**: 8081
- **Database**: PostgreSQL (GORM)

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞
```
server/
‚îú‚îÄ‚îÄ cmd/api/
‚îÇ   ‚îî‚îÄ‚îÄ main.go              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, —Ä–æ—É—Ç–∏–Ω–≥
‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth_handler.go # –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–ª–æ–≥–∏–Ω
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ chat.go         # –ü—Ä–æ–∫—Å–∏ –¥–ª—è AI —á–∞—Ç–∞
‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user.go         # –ú–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ rag_service.go  # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Gemini RAG
‚îÇ   ‚îî‚îÄ‚îÄ database/
‚îÇ       ‚îî‚îÄ‚îÄ database.go     # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
‚îî‚îÄ‚îÄ go.mod
```

### API Endpoints

#### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `POST /api/register` - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –≤ PostgreSQL
  - –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø—Ä–æ—Ñ–∏–ª—å –≤ Google Gemini RAG Store
  
- `POST /api/login` - –í—Ö–æ–¥ –ø–æ email
  - –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î –ø–æ email

#### Chat
- `POST /api/v1/chat/completions` - –ü—Ä–æ–∫—Å–∏ –¥–ª—è AI —á–∞—Ç–∞
  - –ü—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–ø—Ä–æ—Å –æ—Ç —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
  - –ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –Ω–∞ `https://rvlautoai.ru/webhook/v1/chat/completions`
  - –ü–µ—Ä–µ–¥–∞–µ—Ç API –∫–ª—é—á –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è `API_OPEN_AI`

### –ú–æ–¥–µ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```go
type User struct {
    KarmicName    string  // –ö–∞—Ä–º–∏—á–µ—Å–∫–æ–µ –∏–º—è
    SpiritualName string  // –î—É—Ö–æ–≤–Ω–æ–µ –∏–º—è
    Email         string  // Email (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π)
    Gender        string  // –ü–æ–ª
    Country       string  // –°—Ç—Ä–∞–Ω–∞
    City          string  // –ì–æ—Ä–æ–¥
    Identity      string  // –ò–¥–µ–Ω—Ç–∏—á–Ω–æ—Å—Ç—å
    Diet          string  // –î–∏–µ—Ç–∞
    Madh          string  // –¢—Ä–∞–¥–∏—Ü–∏—è (–º–∞–¥—Ö)
    Mentor        string  // –ù–∞—Å—Ç–∞–≤–Ω–∏–∫
    Dob           string  // –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è
    RagFileID     string  // ID —Ñ–∞–π–ª–∞ –≤ RAG —Å–∏—Å—Ç–µ–º–µ
}
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- `DB_HOST` - –•–æ—Å—Ç –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: localhost)
- `DB_PORT` - –ü–æ—Ä—Ç –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 5435)
- `DB_USER` - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: raguser)
- `DB_PASSWORD` - –ü–∞—Ä–æ–ª—å –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: ragpassword)
- `DB_NAME` - –ò–º—è –ë–î (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: ragdb)
- `API_OPEN_AI` - API –∫–ª—é—á –¥–ª—è –≤–Ω–µ—à–Ω–µ–≥–æ AI API

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (PostgreSQL)

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **Image**: postgres:15-alpine
- **Port**: 5435 (host) ‚Üí 5432 (container)
- **Database**: ragdb
- **User**: raguser
- **Password**: ragpassword

### –ú–∏–≥—Ä–∞—Ü–∏–∏
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ GORM –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞.

## RAG Integration (Google Gemini)

### –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ—Ñ–∏–ª—è
1. **–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö** - –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç
2. **Upload File** - –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ –≤ Google Gemini —á–µ—Ä–µ–∑ `upload/v1beta/files`
3. **Import to Store** - –ò–º–ø–æ—Ä—Ç —Ñ–∞–π–ª–∞ –≤ RAG Store —á–µ—Ä–µ–∑ `fileSearchStores/{storeId}:importFile`

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **API Key**: –•–∞—Ä–¥–∫–æ–¥ –≤ `rag_service.go` (TODO: –≤—ã–Ω–µ—Å—Ç–∏ –≤ env)
- **Store ID**: `my-store-tva5a8g0mgj3` (TODO: —Å–¥–µ–ª–∞—Ç—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º)
- **Upload URL**: `https://generativelanguage.googleapis.com/upload/v1beta/files`
- **Import URL**: `https://generativelanguage.googleapis.com/v1beta/fileSearchStores/{storeId}:importFile`

## Proxy Server (Node.js)

### –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ
–û—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ–∫—Å–∏-—Å–µ—Ä–≤–µ—Ä –¥–ª—è Roo Code Nightly –ø–ª–∞–≥–∏–Ω–∞ (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–±–∏–ª—å–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º).

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **Port**: 3001
- **Target**: `https://rvlautoai.ru/webhook`
- **Default Provider**: Capi

### –§—É–Ω–∫—Ü–∏–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ `provider` –≤ –∑–∞–ø—Ä–æ—Å—ã
- –ú–∞–ø–ø–∏–Ω–≥ –º–æ–¥–µ–ª–µ–π –∫ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤/–æ—Ç–≤–µ—Ç–æ–≤

## Docker Compose

### –°–µ—Ä–≤–∏—Å—ã
1. **postgres** - PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
2. **server** - Go –±–µ–∫–µ–Ω–¥ —Å–µ—Ä–≤–µ—Ä

### –ü–æ—Ä—Ç—ã
- PostgreSQL: 5435 (host) ‚Üí 5432 (container)
- Server: 8082 (host) ‚Üí 8080 (container)

## –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

### –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```
Frontend (RegistrationScreen)
  ‚Üí POST /api/register
    ‚Üí Go Backend (auth_handler.go)
      ‚Üí PostgreSQL (save initial user)
      ‚Üí Google Gemini RAG (rag_service.go)
        ‚Üí Upload Profile (native Go HTTP request)
        ‚Üí Import to Store (native Go HTTP request)
        ‚Üí Return RagFileID
      ‚Üí PostgreSQL (update user with RagFileID)
```

### –ß–∞—Ç —Å AI
```
Frontend (App.tsx)
  ‚Üí sendMessage() (openaiService.ts)
    ‚Üí POST http://10.0.2.2:8081/api/v1/chat/completions
      ‚Üí Go Backend (chat.go)
        ‚Üí POST https://rvlautoai.ru/webhook/v1/chat/completions
          ‚Üí External API (RVFreeLLM)
            ‚Üí Response
              ‚Üí Go Backend (–ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ)
                ‚Üí Frontend (–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–∞)
```

### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–Ω–∞—Ç–∞–º–∏ –∏ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞–º–∏ (Communities)
```
Frontend (PortalChatScreen)
  ‚Üí GET /api/v1/rooms
    ‚Üí Go Backend (rooms_handler.go)
      ‚Üí PostgreSQL (fetch rooms/communities)
        ‚Üí Frontend (—Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —á–∞—Ç–æ–≤)
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### Android Emulator Networking
- `10.0.2.2` - —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π IP –∞–¥—Ä–µ—Å Android —ç–º—É–ª—è—Ç–æ—Ä–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ localhost —Ö–æ—Å—Ç–∞
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞ –∫ –±–µ–∫–µ–Ω–¥—É –Ω–∞ —Ö–æ—Å—Ç–µ

### –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ RAG
- –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è –≤ RAG –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ (goroutine)
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –Ω–∞ RAG –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
- –û—à–∏–±–∫–∏ RAG –ª–æ–≥–∏—Ä—É—é—Ç—Å—è, –Ω–æ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —É—Å–ø–µ—à–Ω–æ—Å—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

### –ü—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- Go –±–µ–∫–µ–Ω–¥ –≤—ã—Å—Ç—É–ø–∞–µ—Ç –∫–∞–∫ –ø—Ä–æ–∫—Å–∏ –º–µ–∂–¥—É —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–æ–º –∏ –≤–Ω–µ—à–Ω–∏–º API
- –ü–æ–∑–≤–æ–ª—è–µ—Ç —Å–∫—Ä—ã—Ç—å API –∫–ª—é—á –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### Backend
```bash
cd server
go run cmd/api/main.go
```

### Frontend
```bash
cd frontend
pnpm start
```

### Docker Compose
```bash
docker-compose up -d
```

### –ü–æ–ª–Ω—ã–π –∑–∞–ø—É—Å–∫ (–∏–∑ –∫–æ—Ä–Ω—è)
```bash
pnpm run dev  # Backend + Frontend –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
```

## API Documentation (Unlimited-LLMs / RVFreeLLM)

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–Ω–µ—à–Ω–∏–π API-—à–ª—é–∑ **RVFreeLLM** (Unlimited-LLMs) –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å —Ä–∞–∑–ª–∏—á–Ω—ã–º–∏ AI –º–æ–¥–µ–ª—è–º–∏. –í –ø—Ä–æ–µ–∫—Ç–µ —ç—Ç–æ—Ç API —Ç–∞–∫–∂–µ —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è `API_OPEN_AI`.

### –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- **Base URL**: `https://rvlautoai.ru/webhook`
- **–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö**: JSON (`Content-Type: application/json`)
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: OpenAI API Compatible (—Å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è–º–∏)

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
–í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –º–µ—Ç–æ–¥–∞–º –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `Authorization`.

- **–§–æ—Ä–º–∞—Ç**: `Authorization: Bearer YOUR_API_KEY`
- **–ö–ª—é—á –ø—Ä–æ–µ–∫—Ç–∞**: –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `API_OPEN_AI` (–ø—Ä–µ—Ñ–∏–∫—Å `rvf_`, –¥–ª–∏–Ω–∞ 75 —Å–∏–º–≤–æ–ª–æ–≤)

### –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–π–Ω—Ç—ã

#### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–∞ –∏ —á–∞—Ç
- **–ú–µ—Ç–æ–¥**: `POST /v1/chat/completions`
- **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã**:
  - `model`: –ù–∞–∑–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `gpt-4o`, `meta-llama/Llama-3.3-70B-Instruct-Turbo`)
  - `provider`: –ü—Ä–æ–≤–∞–π–¥–µ—Ä –º–æ–¥–µ–ª–∏ (–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –¥–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, `Capi`, `DeepInfra`)
  - `messages`: –ú–∞—Å—Å–∏–≤ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ñ–æ—Ä–º–∞—Ç–µ OpenAI (`role`, `content`)

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ —á–µ—Ä–µ–∑ –±—ç–∫–µ–Ω–¥ (Go Proxy):**
–ë—ç–∫–µ–Ω–¥ –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã —Å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—è –∫–ª—é—á `API_OPEN_AI` –∏–∑ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

```json
{
  "model": "gpt-4o",
  "provider": "Capi",
  "messages": [
    {"role": "user", "content": "–ü—Ä–∏–≤–µ—Ç, —Ä–∞—Å—Å–∫–∞–∂–∏ –æ —Å–µ–±–µ"}
  ],
  "stream": false
}
```

#### 2. –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
- **–ú–µ—Ç–æ–¥**: `GET /v1/models`
- **–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è**: –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (–ø—É–±–ª–∏—á–Ω—ã–π –º–µ—Ç–æ–¥)
- **–û–ø–∏—Å–∞–Ω–∏–µ**: –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π, –∏—Ö –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤, –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –æ—Ü–µ–Ω–∫—É –∫–∞—á–µ—Å—Ç–≤–∞.

### –¢–∏–ø—ã –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –º–æ–¥–µ–ª–µ–π
| –¢–∏–ø | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ü—Ä–∏–º–µ—Ä—ã –≤ –ø—Ä–æ–µ–∫—Ç–µ |
|-----|------------|------------------|
| `text` | –ß–∞—Ç –∏ —Ç–µ–∫—Å—Ç | `Llama-3.3-70B`, `gpt-4o` |
| `image` | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π | `flux`, `dall-e-3` |
| `audio` | TTS –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è | `alloy`, `whisper` |

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –ø—Ä–æ–µ–∫—Ç–∞
1. **–ú–∞–ø–ø–∏–Ω–≥ –º–æ–¥–µ–ª–µ–π**: –í `frontend/config/models.config.ts` —Å–ª–µ–¥—É–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –∏–º—è –º–æ–¥–µ–ª–∏, –Ω–æ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞.
2. **Fallback**: API –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback. –ï—Å–ª–∏ –æ—Å–Ω–æ–≤–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞, —Å–∏—Å—Ç–µ–º–∞ –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—É—é (–ø–æ–¥—Ä–æ–±–Ω–µ–µ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Unlimited-LLMs).
3. **–õ–æ–∫–∞–ª—å–Ω—ã–π Proxy**: –í –ø—Ä–æ–µ–∫—Ç–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π Proxy-—Å–µ—Ä–≤–µ—Ä (Node.js –Ω–∞ –ø–æ—Ä—Ç—É 3001), –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ –¥–ª—è —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏.

## TODO / –£–ª—É—á—à–µ–Ω–∏—è

1. **RAG Service**:
   - –í—ã–Ω–µ—Å—Ç–∏ API –∫–ª—é—á Google Gemini –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   - –°–¥–µ–ª–∞—Ç—å Store ID –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –∏–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä—É–µ–º—ã–º
   - –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ –∏ retry –ª–æ–≥–∏–∫—É

2. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**:
   - –î–æ–±–∞–≤–∏—Ç—å JWT —Ç–æ–∫–µ–Ω—ã –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
   - –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - Rate limiting

3. **–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å**:
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ RAG –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ —á–∞—Ç–µ (–ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤)
   - –ò—Å—Ç–æ—Ä–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –ë–î
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ —á–∞—Ç–µ
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞–º–∏ –∏ –∫–æ–º–Ω–∞—Ç–∞–º–∏ (–∑–∞–º–µ–Ω–∞ –º–æ–∫–æ–≤ –≤ `PortalChatScreen.tsx`)

5. **–ü–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–Ω—ã–µ –∏–¥–µ–∏ (Social & Community)**:
   - **üì¢ –ö–∞–Ω–∞–ª—ã –≤–µ—â–∞–Ω–∏—è**: –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–Ω–∞—Ç "—Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è" –¥–ª—è –Ω–æ–≤–æ—Å—Ç–µ–π –∏ –∞–Ω–æ–Ω—Å–æ–≤.
   - **üìç –ì–µ–æ-—á–∞—Ç—ã**: –ü–æ–∏—Å–∫ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–º–Ω–∞—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ –º–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
   - **ü§ñ AI-–º–æ–¥–µ—Ä–∞—Ç–æ—Ä**: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ AI –≤ –≥—Ä—É–ø–ø–æ–≤—ã–µ —á–∞—Ç—ã –¥–ª—è –ø–æ–º–æ—â–∏ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º –∏ –º–æ–¥–µ—Ä–∞—Ü–∏–∏.
   - **üìä –û–ø—Ä–æ—Å—ã (Polls)**: –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è –≤–Ω—É—Ç—Ä–∏ —Å–æ–æ–±—â–µ—Å—Ç–≤.

4. **–ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞**:
   - –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏)
   - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –º–µ—Ç—Ä–∏–∫–∏
   - CI/CD pipeline

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —Ä–∞–±–æ—Ç–µ —Å RAG (API Restrictions)

### 1. –†–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è Google
Google Gemini API (–æ—Å–æ–±–µ–Ω–Ω–æ Semantic Retrieval / Corpora) –∏–º–µ–µ—Ç –∂–µ—Å—Ç–∫–∏–µ –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è. –ï—Å–ª–∏ —Å–µ—Ä–≤–µ—Ä –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–º —Ä–µ–≥–∏–æ–Ω–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –†–§), –ø—Ä—è–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏–∑ Go-–±—ç–∫–µ–Ω–¥–∞ –∫ `generativelanguage.googleapis.com` –±—É–¥—É—Ç –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –æ—à–∏–±–∫—É `400 Bad Request: User location is not supported`.

### 2. –°–ø–æ—Å–æ–±—ã —Ä–µ—à–µ–Ω–∏—è
*   **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ VDS –≤ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ–º —Ä–µ–≥–∏–æ–Ω–µ**: –ë—ç–∫–µ–Ω–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ –°–®–ê –∏–ª–∏ –ï–≤—Ä–æ–ø–µ), –≥–¥–µ API –¥–æ—Å—Ç—É–ø–Ω–æ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.
*   **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HTTP-–ø—Ä–æ–∫—Å–∏**: –í `rag_service.go` –º–æ–∂–Ω–æ –≤–Ω–µ–¥—Ä–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `PROXY_URL` –≤ `.env`, —á—Ç–æ–±—ã –∑–∞–ø—Ä–æ—Å—ã –∫ Google —à–ª–∏ —á–µ—Ä–µ–∑ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–π IP.
*   **–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ Corpus**: –°–æ–∑–¥–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ (Corpus) —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤—ã–ø–æ–ª–Ω—è—Ç—å –æ–¥–∏–Ω —Ä–∞–∑ —á–µ—Ä–µ–∑ VPN –∏–ª–∏ —É–¥–∞–ª–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä, –ø–æ—Å–ª–µ —á–µ–≥–æ –ø—Ä–æ–ø–∏—Å—ã–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–π `GEMINI_CORPUS_ID` –≤ –∫–æ–Ω—Ñ–∏–≥.

### 3. –†–µ–∑–µ—Ä–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (File API)
–ï—Å–ª–∏ —Ä–∞–±–æ—Ç–∞ —Å `corpora` –æ—Å—Ç–∞–µ—Ç—Å—è –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ–π –∏–∑-–∑–∞ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–µ–¥—É—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ **Gemini File API**. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∫–∞–∫ –æ–±—ã—á–Ω—ã–π —Ñ–∞–π–ª, –∫–æ—Ç–æ—Ä—ã–π –ø–µ—Ä–µ–¥–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç –º–æ–¥–µ–ª–∏ (`generateContent`) –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ, —á—Ç–æ –º–µ–Ω–µ–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –∫ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã–º –ø—Ä–æ–≤–µ—Ä–∫–∞–º –Ω–∞ —ç—Ç–∞–ø–µ –ø–æ–∏—Å–∫–∞.

